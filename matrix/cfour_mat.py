import numpy as np

hbar = 5.806484171
b_to_a = 0.5291772083
F = np.array(
        [[ 0.62280599, -0.00437212,  0.03025096],
         [-0.00437212,  0.62280599,  0.03025096],
         [ 0.03025096,  0.03025096,  0.18119835]])
F = F * (b_to_a**2)
GF = np.array(
        [[ 0.65595364, -0.01545854,  0.02530008],
         [-0.01545854,  0.65595364,  0.02530008],
         [-0.00066762, -0.00066762,  0.11927533]])

GF_N = np.array(
    [[ 5.13723E+05, -1.20793E+04,  1.05408E+04],
     [-1.20884E+04,  5.13667E+05,  1.04044E+04],
     [-8.38628E+02, -1.13948E+03,  9.38646E+04]])

L = np.array(
        [[ 7.07106781e-01, -7.07105621e-01, -4.84321654e-02],
         [-7.07106781e-01, -7.07105621e-01, -4.84321654e-02],
         [-5.98649051e-18,  1.81166997e-03,  9.97651568e-01]])

labda = np.array([0.67141218, 0.64043027, 0.11934015])

F_N = np.array(        
    [[ 4.877666490402689E+05, -3.402909255277740E+03,  1.260024558228502E+04],
     [-3.402909255277740E+03,  4.877062385099230E+05,  1.247280561832061E+04],
     [ 1.260024558228502E+04,  1.247280561832061E+04,  3.992753726783524E+04]])


#Col sort
L[:,[2,0]] = L[:,[0,2]]
labda [[2,0]] = labda[[0,2]]

Lc = L.copy()

for i in range(3):
    temp = 0
    for j in range(3):
        for k in range(3):
            temp += L[i,k] * L[i,j] * F[k,j]
    temp = abs(temp)
    temp = np.sqrt(hbar*np.sqrt(abs(labda[i])) / temp)
    for j in range(3):
        Lc[i,j] *= temp 





strang = ''
for i in range(3):
    for j in range(3):
        strang += ' {} '.format(GF_N[i,j] / GF[i,j])
    strang += '\n'
